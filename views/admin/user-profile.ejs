<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>GetAllRegisterUser</title>
    <!-- Tell the browser to be responsive to screen width -->
  </head>

  <body class="hold-transition sidebar-mini layout-fixed">
    <div class="loading"></div>
   <!-- Navbar -->
        <%- include('./partials/sidebar.ejs');  %> 
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <%- include('./partials/header.ejs');  %>
        <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <div class="main-content">
          <div class="page-content">
            <div class="container-fluid">
              <div class="row">
               
                <div class="card col-12">
                    <div class="card-header">
                      <h3 class="card-title">All Registered Users</h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                      <table
                        id="example1"
                        class="table table-bordered table-striped"
                      >
                        <thead>
                          <tr>
                            <th>S#No</th>
                            <th>Image</th>
                            <th>Full Name</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Contact Number</th>
                            <th>Country</th>
                            <th>Address</th>
                            <th>Date</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% if(locals.users) { %> <% var sr = 1;
                          users.forEach((user) => { %>
                          <tr id="record_<%=users._id%>">
                            <td><%= sr %></td>
                            <td><img src="/<%= user.image %>"></td>
                            <td><%= user.fullName %></td>
                            <td><%= user.username %></td>
                            <td><%= user.email %></td>
                            <td><%= user.contactNumber %></td>
                            <td><%= user.country %></td>
                            <td><%= user.address %></td>
                            <td>
                              <%= user.createdAt.toLocaleString('en-US', {
                              weekday: 'short', year: 'numeric', month: 'short',
                              day: 'numeric' })%>
                            </td>
  
                            <td>
                              <a
                                href="/admin/delete/getAllRegisterUser/<%=user._id%>"
                                class="btn btn-danger btn-sm"
                                >Delete</a
                              >
                            </td>
                          </tr>
                          <% sr++; }); %> <% } %>
                        </tbody>
                        <tfoot>
                          <tr>
                            <th>S#No</th>
                            <th>Image</th>
                            <th>Full Name</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Contact Number</th>
                            <th>Country</th>
                            <th>Address</th>
                            <th>Date</th>
                            <th>Action</th>
                          </tr>
                        </tfoot>
                      </table>
                    </div>
                    <!-- /.card-body -->
                  </div>
              </div>
              <!-- ./col -->
            
            </div>
            <%- include('./partials/footer.ejs');  %>
          </div>
        </div>
      </div>
    </div>

    <script src="/plugins/datatables/jquery.dataTables.js"></script>
    <script src="/plugins/datatables-bs4/js/dataTables.bootstrap4.js"></script>

    <script>
      $("#addCuntry").submit(function (e) {
        e.preventDefault(); // avoid to execute the actual submit of the form.
        $(".loading").css("display", "block");
        $.ajax({
          type: "POST",
          url: "/admin/country/add",
          processData: false,
          contentType: false,
          data: new FormData(this),
          // serializes the form's elements.
          success: function (data) {
            $(".loading").css("display", "none");
            window.location = "/admin/country";
          },
        });
      });

   
      function removeThisRow(data) {
        $("#record_" + data).remove();
      }

      $(function () {
        $("#example1").DataTable();
      });
    </script>
  </body>
</html>
